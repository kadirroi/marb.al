<html>

	<body>

		<canvas id="myCanvas" width="500" height="500">

		</canvas>
		Click on the canvas.
		<script type="text/javascript">
			
			// PREPARE CANVAS - GET GL CONTEXT
			var canvas = document.getElementById("myCanvas");
			canvas.addEventListener("mousedown", scale, false);
			var gl = canvas.getContext("experimental-webgl");
			if (!gl){
				alert("GL FUCKED UP BRUH");
			}
			
			// DEFINE AND STORE THE GEOMETRY
			var vertices = [
				-0.5, 0.5, 0.0,
				0.5, 0.5, 0.0,
				0.5, -0.5, 0.0,
				-0.5, -0.5, 0.0
			];
			var indices = [0,1,2,0,3,2];
			var vertexBuffer = gl.createBuffer();
			gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
			gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);
			gl.bindBuffer(gl.ARRAY_BUFFER, null);
			var indexBuffer = gl.createBuffer();
			gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
			gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);
			gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);
			
			// SHADER HANDLING
			var vertexShaderCode = 
				'attribute vec4 coordinates;'+
				'uniform mat4 u_xformMatrix;'+
				'void main(void) {'+
					'gl_Position= u_xformMatrix * coordinates ;'+
				'}';
			var vertexShader = gl.createShader(gl.VERTEX_SHADER);
			gl.shaderSource(vertexShader, vertexShaderCode);
			gl.compileShader(vertexShader);
			
			var fragmentShaderCode = 
				'void main(void) {'+
					'gl_FragColor=vec4(0.0,0.0,0.0,1.0);'+
				'}';
			var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
			gl.shaderSource(fragmentShader, fragmentShaderCode);
			gl.compileShader(fragmentShader);

			var shaderProgram = gl.createProgram();
			gl.attachShader(shaderProgram, vertexShader);
			gl.attachShader(shaderProgram, fragmentShader);
			gl.linkProgram(shaderProgram);
			gl.useProgram(shaderProgram);

			// SCALING
			var sx=1.0, sy=1.0, sz=1.0;
			var xformMatrix = new Float32Array([
				sx, 0.0, 0.0, 0.0,
				0.0, sy, 0.0, 0.0,
				0.0, 0.0, sz, 0.0,
				0.0, 0.0, 0.0, 1.0
			]);

			var u_xformMatrix = gl.getUniformLocation(shaderProgram, 'u_xformMatrix');
			gl.uniformMatrix4fv(u_xformMatrix, false, xformMatrix);

			// ASSOCIATING SHADERS TO BUFFER OBJECTS
			gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
			gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
			var coord = gl.getAttribLocation(shaderProgram, "coordinates");
			gl.vertexAttribPointer(coord, 3, gl.FLOAT, false, 0, 0);
			gl.enableVertexAttribArray(coord);

			// DRAWING
			gl.clearColor(0.3, 0.8, 0.5, 1.0);
			gl.enable(gl.DEPTH_TEST);
			gl.clear(gl.COLOR_BUFFER_BIT);
			gl.viewport(0, 0, canvas.width, canvas.height);
			gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT,0);
			
			function scale(event){
			// SCALING
			var sx=1.5, sy=1.5, sz=1.5;
			var xformMatrix = new Float32Array([
				sx, 0.0, 0.0, 0.0,
				0.0, sy, 0.0, 0.0,
				0.0, 0.0, sz, 0.0,
				0.0, 0.0, 0.0, 1.0
			]);

			var u_xformMatrix = gl.getUniformLocation(shaderProgram, 'u_xformMatrix');
			gl.uniformMatrix4fv(u_xformMatrix, false, xformMatrix);		
			// DRAWING
			gl.clearColor(0.3, 0.8, 0.5, 1.0);
			gl.enable(gl.DEPTH_TEST);
			gl.clear(gl.COLOR_BUFFER_BIT);
			gl.viewport(0, 0, canvas.width, canvas.height);
			gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT,0);			
			}
		</script>

	</body>

</html>
